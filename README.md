# School Management System

Sistema completo de gest√£o escolar desenvolvido com Spring Boot 3.5.6 e Java 21.

## √çndice

- [Vis√£o Geral](#vis√£o-geral)
- [Tecnologias](#tecnologias)
- [Funcionalidades](#funcionalidades)
- [Regras do Sistema Educacional](#regras-do-sistema-educacional)
- [Configura√ß√£o e Instala√ß√£o](#configura√ß√£o-e-instala√ß√£o)
- [Documenta√ß√£o](#documenta√ß√£o)
- [API Endpoints](#api-endpoints)
- [Testes](#testes)
- [Estrutura do Projeto](#estrutura-do-projeto)

---

## Vis√£o Geral

O School Management System √© uma aplica√ß√£o REST API completa para gerenciamento de institui√ß√µes de ensino, oferecendo controle de:

- **Usu√°rios** (Administradores, Professores, Alunos, Respons√°veis)
- **Matr√≠culas** e Transfer√™ncias de Alunos
- **Turmas** e Salas de Aula
- **Disciplinas** e Professores
- **Notas** e Avalia√ß√µes
- **Frequ√™ncia** e Presen√ßa
- **Boletins** e Hist√≥rico Acad√™mico
- **Relat√≥rios** Gerenciais
- **Eventos** Escolares

---

## Tecnologias

### Backend
- **Java 21**
- **Spring Boot 3.5.6**
- **Spring Data JPA** - Persist√™ncia de dados
- **Spring Validation** - Valida√ß√£o de dados
- **Hibernate** - ORM

### Banco de Dados
- **H2 Database** (desenvolvimento)
- Suporte para MySQL/PostgreSQL (produ√ß√£o)

### Documenta√ß√£o
- **SpringDoc OpenAPI 3** (Swagger UI)

### Testes
- **JUnit 5** - Framework de testes
- **Mockito** - Mocks para testes unit√°rios
- **JaCoCo** - Cobertura de c√≥digo (meta: 85%)
- **Spring Boot Test** - Testes de integra√ß√£o

### Ferramentas
- **Lombok** - Redu√ß√£o de boilerplate
- **Maven** - Gerenciamento de depend√™ncias

---

## Funcionalidades

### Gerenciamento de Usu√°rios
- ‚úÖ Cadastro de usu√°rios com valida√ß√£o de CPF
- ‚úÖ Perfis de acesso (Admin, Teacher, Student)
- ‚úÖ Autentica√ß√£o e autoriza√ß√£o
- ‚úÖ Gest√£o de dados cadastrais

### Gest√£o Acad√™mica
- ‚úÖ Matr√≠cula de alunos
- ‚úÖ Cria√ß√£o e gest√£o de turmas
- ‚úÖ Controle de capacidade de salas
- ‚úÖ Transfer√™ncia entre turmas
- ‚úÖ Atribui√ß√£o de professores √†s disciplinas

### Notas e Avalia√ß√µes
- ‚úÖ Registro de notas (escala 0-10)
- ‚úÖ M√∫ltiplos tipos de avalia√ß√£o (Prova, Trabalho, Teste, etc.)
- ‚úÖ C√°lculo autom√°tico de m√©dias
- ‚úÖ Sistema de bimestres (4 quarters)
- ‚úÖ Gera√ß√£o de boletins

### Frequ√™ncia
- ‚úÖ Registro di√°rio de presen√ßa/falta
- ‚úÖ Justificativa de aus√™ncias
- ‚úÖ C√°lculo autom√°tico de percentual de frequ√™ncia
- ‚úÖ Alertas para frequ√™ncia abaixo de 75%

### Relat√≥rios
- ‚úÖ Relat√≥rio de notas por turma
- ‚úÖ Relat√≥rio de frequ√™ncia
- ‚úÖ Relat√≥rio de aprova√ß√£o/reprova√ß√£o
- ‚úÖ Relat√≥rio de evas√£o escolar
- ‚úÖ Exporta√ß√£o CSV/Excel

### Eventos Escolares
- ‚úÖ Calend√°rio de eventos
- ‚úÖ Reuni√µes de pais
- ‚úÖ Feriados e recessos
- ‚úÖ Datas de provas

---

## Regras do Sistema Educacional

### Estrutura Acad√™mica

#### Ano Letivo
- Dividido em **4 bimestres**
- Cada bimestre possui notas e frequ√™ncia independentes
- Sistema de recupera√ß√£o por bimestre

#### Turmas
- **Capacidade m√°xima** configur√°vel
- Bloqueio autom√°tico de matr√≠culas quando lotada
- Controle de turno (Manh√£, Tarde, Noite)
- Ano letivo espec√≠fico (ex: 2025)

#### N√∫mero de Matr√≠cula
- **Formato:** YYYY###### (ano + 6 d√≠gitos)
- **Exemplo:** 2025000001
- √önico e permanente para cada aluno
- Gerado no ato da matr√≠cula

### Sistema de Avalia√ß√£o

#### Escala de Notas
- **M√≠nima:** 0.0
- **M√°xima:** 10.0
- Precis√£o de duas casas decimais

#### Tipos de Avalia√ß√£o
- **EXAM** - Prova
- **ASSIGNMENT** - Trabalho
- **TEST** - Teste
- **PARTICIPATION** - Participa√ß√£o
- **PROJECT** - Projeto
- **OTHER** - Outros

#### C√°lculo de M√©dias
```
M√©dia do Bimestre = Soma de todas as notas / Quantidade de avalia√ß√µes
M√©dia Final = (M√©dia 1¬∫ Bim + M√©dia 2¬∫ Bim + M√©dia 3¬∫ Bim + M√©dia 4¬∫ Bim) / 4
```

### Crit√©rios de Aprova√ß√£o

#### Por Nota
- **‚â• 7.0:** APROVADO
- **5.0 a 6.9:** RECUPERA√á√ÉO
- **< 5.0:** REPROVADO

#### Por Frequ√™ncia
- **‚â• 75%:** Frequ√™ncia adequada
- **< 75%:** REPROVADO por falta (independente da nota)

#### Status do Boletim
- **APPROVED:** Aprovado em todas as disciplinas
- **RECOVERY:** Necessita recupera√ß√£o em uma ou mais disciplinas
- **FAILED:** Reprovado por nota ou frequ√™ncia
- **STUDYING:** Ano letivo em andamento

### Recupera√ß√£o

#### Regras
- Dispon√≠vel para alunos com m√©dia entre 5.0 e 6.9
- Pode ser oferecida por bimestre ou final
- Nova nota substitui ou calcula nova m√©dia conforme crit√©rio da escola

### Frequ√™ncia

#### Presen√ßa/Falta
- Registro obrigat√≥rio por aula
- Professor respons√°vel pelo lan√ßamento
- Faltas podem ser justificadas posteriormente

#### Justificativas Aceitas
- Atestado m√©dico
- Declara√ß√£o de comparecimento
- Eventos oficiais
- Outros conforme regimento escolar

#### C√°lculo
```
Percentual de Frequ√™ncia = (Total de Presen√ßas / Total de Aulas) √ó 100
```

### Transfer√™ncias

#### Regras
- Permitida entre turmas da mesma institui√ß√£o
- Turma destino deve ter vagas dispon√≠veis
- Mant√©m hist√≥rico acad√™mico completo
- Atualiza ocupa√ß√£o das turmas automaticamente

### Valida√ß√µes Autom√°ticas

#### CPF
- Deve ser v√°lido segundo algoritmo oficial
- √önico no sistema
- N√£o pode ser alterado ap√≥s cadastro

#### Email
- Formato v√°lido
- √önico por usu√°rio

#### N√∫mero de Matr√≠cula
- Formato YYYY######
- Ano deve estar entre 1900 e ano atual
- √önico no sistema
- N√£o pode ser alterado

#### Senha
- M√≠nimo 8 caracteres
- Armazenada com hash (seguran√ßa)

#### Telefone
- Entre 10 e 15 d√≠gitos
- Formato brasileiro aceito

---

## Configura√ß√£o e Instala√ß√£o

### Pr√©-requisitos
- Java 21 ou superior
- Maven 3.6+
- IDE (IntelliJ IDEA, Eclipse, VS Code)

### Instala√ß√£o

1. **Clone o reposit√≥rio**
```bash
git clone <repository-url>
cd school-management-system-spring
```

2. **Configure o banco de dados** (opcional)

O sistema usa H2 por padr√£o. Para produ√ß√£o, edite `application.properties`:

```properties
# MySQL
spring.datasource.url=jdbc:mysql://localhost:3306/school_db
spring.datasource.username=root
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# PostgreSQL
spring.datasource.url=jdbc:postgresql://localhost:5432/school_db
spring.datasource.username=postgres
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
```

3. **Compile o projeto**
```bash
./mvnw clean compile
```

4. **Execute os testes**
```bash
./mvnw test
```

5. **Inicie a aplica√ß√£o**
```bash
./mvnw spring-boot:run
```

A aplica√ß√£o estar√° dispon√≠vel em: `http://localhost:8080`

### Acessar Documenta√ß√£o da API

- **Swagger UI:** http://localhost:8080/swagger-ui.html
- **OpenAPI JSON:** http://localhost:8080/v3/api-docs

### Console H2 (Desenvolvimento)

- **URL:** http://localhost:8080/h2-console
- **JDBC URL:** jdbc:h2:mem:testdb
- **Username:** sa
- **Password:** (em branco)

---

## Documenta√ß√£o

### Manuais de Usu√°rio

- üìò [**Manual do Administrador**](docs/ADMIN_MANUAL.md)
  - Gerenciamento completo do sistema
  - Cadastros, relat√≥rios e configura√ß√µes

- üìó [**Manual do Professor**](docs/TEACHER_MANUAL.md)
  - Lan√ßamento de notas e frequ√™ncia
  - Gera√ß√£o de boletins
  - Acompanhamento de turmas

- üìô [**Manual do Respons√°vel**](docs/GUARDIAN_MANUAL.md)
  - Acompanhamento de alunos
  - Consulta de notas e frequ√™ncia
  - Visualiza√ß√£o de boletins

### Documenta√ß√£o T√©cnica

- **API Reference:** Swagger UI (http://localhost:8080/swagger-ui.html)
- **OpenAPI Spec:** JSON format (http://localhost:8080/v3/api-docs)

---

## API Endpoints

### Principais Recursos

#### Students (Alunos)
```
POST   /student                          - Matricular aluno
GET    /student/id/{id}                  - Buscar por ID
GET    /student/enrollment/{number}      - Buscar por matr√≠cula
GET    /student/classroom/{id}           - Listar por turma
GET    /student/academic-history/{number}- Hist√≥rico completo
PUT    /student/{number}                 - Atualizar dados
PUT    /student/{number}/transfer/{id}   - Transferir turma
```

#### Grades (Notas)
```
POST   /grade                            - Registrar nota
GET    /grade/student/{id}               - Notas do aluno
GET    /grade/average                    - Calcular m√©dia
PUT    /grade/{id}                       - Atualizar nota
GET    /grade/report-card/{id}/{quarter} - Gerar boletim
```

#### Attendance (Frequ√™ncia)
```
POST   /attendance                       - Registrar presen√ßa
GET    /attendance/student/{id}          - Frequ√™ncia do aluno
GET    /attendance/classroom/{id}/date   - Lista de chamada
PUT    /attendance/{id}/justify          - Justificar falta
GET    /attendance/calculate/{id}        - Calcular percentual
```

#### Classrooms (Turmas)
```
POST   /classroom                        - Criar turma
GET    /classroom/all                    - Listar todas
GET    /classroom/{id}                   - Buscar por ID
PUT    /classroom/{id}                   - Atualizar
```

#### Reports (Relat√≥rios)
```
GET    /report/grades/classroom/{id}     - Notas da turma
GET    /report/attendance/classroom/{id} - Frequ√™ncia da turma
GET    /report/approval                  - Relat√≥rio de aprova√ß√£o
GET    /report/dropout                   - Relat√≥rio de evas√£o
GET    /report/export/csv/{id}           - Exportar CSV
GET    /report/export/excel/{id}         - Exportar Excel
```

---

## Testes

### Executar Testes

```bash
# Todos os testes
./mvnw test

# Apenas testes unit√°rios
./mvnw test -Dtest=*ServiceTest

# Apenas testes de integra√ß√£o
./mvnw test -Dtest=*IntegrationTest

# Com relat√≥rio de cobertura
./mvnw clean test jacoco:report
```

### Cobertura de C√≥digo

Ap√≥s executar os testes com JaCoCo:

```bash
# Visualizar relat√≥rio
open target/site/jacoco/index.html
```

**Meta de Cobertura:** 85%

### Tipos de Testes

#### Testes Unit√°rios (36 testes)
- `StudentServiceTest` - 9 testes
- `GradeServiceTest` - 9 testes
- `AttendanceServiceTest` - 10 testes
- `ReportCardServiceTest` - 8 testes

#### Testes de Reposit√≥rio (12 testes)
- `StudentRepositoryTest` - 6 testes
- `GradeRepositoryTest` - 6 testes

#### Testes de Integra√ß√£o (17 testes)
- `StudentEnrollmentIntegrationTest` - 6 testes
- `GradesReportCardIntegrationTest` - 6 testes
- `UserRoleIntegrationTest` - 5 testes

**Total:** 65+ testes

---

## Estrutura do Projeto

```
school-management-system-spring/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ java/com/nagi/school_management_system_spring/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/          # Configura√ß√µes (Swagger, etc)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controller/      # REST Controllers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/             # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exception/       # Exception Handlers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mapper/          # Entity ‚Üî DTO Mappers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model/           # Entidades JPA
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ enums/       # Enumera√ß√µes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/      # Reposit√≥rios JPA
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/         # L√≥gica de Neg√≥cio
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation/      # Validadores Customizados
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ application.properties
‚îÇ   ‚îî‚îÄ‚îÄ test/
‚îÇ       ‚îî‚îÄ‚îÄ java/com/nagi/school_management_system_spring/
‚îÇ           ‚îú‚îÄ‚îÄ integration/     # Testes de Integra√ß√£o
‚îÇ           ‚îú‚îÄ‚îÄ repository/      # Testes de Reposit√≥rio
‚îÇ           ‚îú‚îÄ‚îÄ service/         # Testes Unit√°rios
‚îÇ           ‚îî‚îÄ‚îÄ util/            # Utilit√°rios de Teste
‚îú‚îÄ‚îÄ docs/                        # Documenta√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ ADMIN_MANUAL.md
‚îÇ   ‚îú‚îÄ‚îÄ TEACHER_MANUAL.md
‚îÇ   ‚îî‚îÄ‚îÄ GUARDIAN_MANUAL.md
‚îú‚îÄ‚îÄ pom.xml
‚îî‚îÄ‚îÄ README.md
```

---

## Valida√ß√µes Customizadas

O sistema inclui validadores customizados para:

### ValidCPF
Valida CPF brasileiro com d√≠gitos verificadores

### ValidEnrollmentNumber
Valida formato YYYY###### e verifica ano v√°lido

### Outras Valida√ß√µes
- Email √∫nico
- Telefone no formato correto
- Datas v√°lidas
- Notas entre 0 e 10

---

## Tratamento de Exce√ß√µes

### Exce√ß√µes Customizadas

- `ResourceNotFoundException` - Recurso n√£o encontrado
- `StudentAlreadyEnrolledException` - Matr√≠cula duplicada
- `ClassroomFullException` - Turma lotada
- `InvalidGradeException` - Nota inv√°lida
- `InsufficientAttendanceException` - Frequ√™ncia insuficiente

### GlobalExceptionHandler

Captura todas as exce√ß√µes e retorna respostas padronizadas:

```json
{
  "timestamp": "2025-10-03T14:30:00",
  "status": 404,
  "error": "Not Found",
  "message": "Student not found with id: 123",
  "path": "/student/id/123"
}
```

---

## Contribuindo

### Code Standards

- C√≥digo, vari√°veis e m√©todos em **ingl√™s**
- Commits em **ingl√™s**
- Documenta√ß√£o em **portugu√™s**
- Seguir conven√ß√µes Java (camelCase, PascalCase)
- Sem emojis em c√≥digo ou commits

### Padr√£o de Commits

```
feat: add new feature
fix: correct bug
refactor: improve code structure
docs: update documentation
test: add tests
```

---

## Licen√ßa

MIT License

---

## Suporte

- **Email:** support@schoolmanagement.com
- **Issues:** GitHub Issues
- **Documentation:** Swagger UI

---

## Roadmap

### Vers√£o 2.0 (Planejado)
- [ ] Autentica√ß√£o JWT
- [ ] Sistema de permiss√µes granular
- [ ] Notifica√ß√µes por email/SMS
- [ ] Dashboard com gr√°ficos
- [ ] App mobile
- [ ] Integra√ß√£o com sistemas de pagamento
- [ ] Sistema de mensagens internas
- [ ] Biblioteca virtual
- [ ] Gest√£o de transporte escolar

---

## Autores

- **Nagiitoshi** - Desenvolvimento Inicial

---

**Desenvolvido com Spring Boot 3.5.6 e Java 21**
